<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of drawCbMap</title>
  <meta name="keywords" content="drawCbMap">
  <meta name="description" content="Draws a map with the specified optional parameters">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<!-- ../menu.html cobra --><!-- menu.html maps -->
<h1>drawCbMap
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>Draws a map with the specified optional parameters</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function options = drawCbMap(map,options,varargin) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment">Draws a map with the specified optional parameters

 drawCbMap(map,options)

INPUTS
 map                       COBRA map structure

OPTIONAL INPUTS
 options                  Structure containing optional parameters
   nodeWeight              Size of primary metabolite nodes  
   nodeWeightSecondary     Size of secondary metabolite nodes
   nodeColor               Color of metabolite nodes
   edgeColor               Color of reaction arrows2
   edgeArrowColor          Color of reaction arrowheads
   edgeWeight              Width of reaction arrows
   textSize                Font size of metabolite text
   textColor               Text color for metaboltes
   rxnTextSize             Font size of reaction text
   rxnTextColor            Text color for reactions
   otherTextColor          Color of other text
   fileName                Name of output file

 varargin                  optional parameter name / parameter value pairs

OUTPUT
 Displays map in a matlab figure ('matlab') or target.svg ('svg') file
 depending on value of CB_MAP_OUTPUT.
 options                  Structure containing optional parameters</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="plotcbmap.html" class="code" title="function plotcbmap()">plotcbmap</a>	</li><li><a href="../../cobra/maps/tools/drawCircle.html" class="code" title="function drawCircle(p,radius,color)">drawCircle</a>	drawCircle draw a circle in a figure</li><li><a href="../../cobra/maps/tools/drawLine.html" class="code" title="function drawLine(node1,node2,map,edgeColor,edgeArrowColor,edgeWeight,nodeWeight,rxnDir,rxnDirMultiplier)">drawLine</a>	drawLine</li><li><a href="../../cobra/maps/tools/drawShape.html" class="code" title="function drawShape(sType,begPt,sLength, color, thickness,sStyle,verbose)">drawShape</a>	drawShape Draw shapes to figure</li><li><a href="../../cobra/maps/tools/drawText.html" class="code" title="function drawText(x,y, drawString, fontSize, fontStyle, color, font, fontWeight, flagCenter)">drawText</a>	drawText Draws text to figure</li></ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="drawConc.html" class="code" title="function options = drawConc(map,model,conc,options,varargin)">drawConc</a>	drawConc overlays a flux distribution onto a reaction map</li><li><a href="drawFlux.html" class="code" title="function options = drawFlux(map,model,flux,options,varargin)">drawFlux</a>	drawFlux overlays a flux distribution onto a reaction map</li><li><a href="drawFluxVariability.html" class="code" title="function options = drawFluxVariability(map,model,minFlux,maxFlux,options,varargin)">drawFluxVariability</a>	drawFluxVariablity Overlay flux variability data on a metabolic map</li></ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function options = drawCbMap(map,options,varargin)</a>
0002 <span class="comment">%Draws a map with the specified optional parameters</span>
0003 <span class="comment">%</span>
0004 <span class="comment">% drawCbMap(map,options)</span>
0005 <span class="comment">%</span>
0006 <span class="comment">%INPUTS</span>
0007 <span class="comment">% map                       COBRA map structure</span>
0008 <span class="comment">%</span>
0009 <span class="comment">%OPTIONAL INPUTS</span>
0010 <span class="comment">% options                  Structure containing optional parameters</span>
0011 <span class="comment">%   nodeWeight              Size of primary metabolite nodes</span>
0012 <span class="comment">%   nodeWeightSecondary     Size of secondary metabolite nodes</span>
0013 <span class="comment">%   nodeColor               Color of metabolite nodes</span>
0014 <span class="comment">%   edgeColor               Color of reaction arrows2</span>
0015 <span class="comment">%   edgeArrowColor          Color of reaction arrowheads</span>
0016 <span class="comment">%   edgeWeight              Width of reaction arrows</span>
0017 <span class="comment">%   textSize                Font size of metabolite text</span>
0018 <span class="comment">%   textColor               Text color for metaboltes</span>
0019 <span class="comment">%   rxnTextSize             Font size of reaction text</span>
0020 <span class="comment">%   rxnTextColor            Text color for reactions</span>
0021 <span class="comment">%   otherTextColor          Color of other text</span>
0022 <span class="comment">%   fileName                Name of output file</span>
0023 <span class="comment">%</span>
0024 <span class="comment">% varargin                  optional parameter name / parameter value pairs</span>
0025 <span class="comment">%</span>
0026 <span class="comment">%OUTPUT</span>
0027 <span class="comment">% Displays map in a matlab figure ('matlab') or target.svg ('svg') file</span>
0028 <span class="comment">% depending on value of CB_MAP_OUTPUT.</span>
0029 <span class="comment">% options                  Structure containing optional parameters</span>
0030 <span class="comment">%</span>
0031 <span class="comment">%</span>
0032 
0033 <span class="keyword">global</span> mapHandle
0034 <span class="keyword">global</span> CB_MAP_OUTPUT
0035 
0036 <span class="comment">%check for render output</span>
0037 <span class="keyword">if</span> ~exist(<span class="string">'CB_MAP_OUTPUT'</span>, <span class="string">'var'</span>) || isempty(CB_MAP_OUTPUT)
0038     error(<span class="string">'No render target specified.  Call changeCbMapOutput(outputFormat)'</span>);
0039 <span class="keyword">end</span>
0040 
0041 
0042 <span class="keyword">if</span> (nargin &lt; 2)
0043     options = [];
0044 <span class="keyword">end</span>
0045 
0046 <span class="keyword">if</span> mod(length(varargin),2)==0
0047     <span class="keyword">for</span> i=1:2:length(varargin)-1
0048         <span class="keyword">switch</span> lower(varargin{i})
0049             <span class="keyword">case</span> <span class="string">'nodeweight'</span>, options.nodeWeight = cell2mat(varargin(i+1));
0050             <span class="keyword">case</span> <span class="string">'nodecolor'</span>, options.nodeColor = cell2mat(varargin(i+1));
0051             <span class="keyword">case</span> <span class="string">'edgeweight'</span>, options.edgeWeight = cell2mat(varargin(i+1));
0052             <span class="keyword">case</span> <span class="string">'edgecolor'</span>, options.edgeColor = cell2mat(varargin(i+1));
0053             <span class="keyword">case</span> <span class="string">'edgearrowcolor'</span>, options.edgeArrowColor = cell2mat(varargin(i+1));
0054             <span class="keyword">case</span> <span class="string">'textsize'</span>, options.textSize = cell2mat(varargin(i+1));
0055             <span class="keyword">case</span> <span class="string">'textcolor'</span>, options.textColor = cell2mat(varargin(i+1));
0056             <span class="keyword">case</span> <span class="string">'othertextsize'</span>, options.otherTextSize = cell2mat(varargin(i+1));
0057             <span class="keyword">case</span> <span class="string">'othertextcolor'</span>, options.otherTextColor = cell2mat(varargin(i+1));
0058             <span class="keyword">case</span> <span class="string">'filename'</span>, options.fileName = varargin{i+1};
0059             <span class="keyword">otherwise</span>, options.(varargin{i}) = varargin{i+1};
0060         <span class="keyword">end</span>
0061     <span class="keyword">end</span>
0062 <span class="keyword">else</span>
0063     error(<span class="string">'Invalid number of parameters/values'</span>);
0064 <span class="keyword">end</span>
0065 
0066 <span class="comment">%%%% Compelete the missing parts of the option</span>
0067 nNodes = size(map.molName,1);
0068 nEdges = size(map.connection,1);
0069 <span class="comment">%Node size</span>
0070 <span class="keyword">if</span> ~isfield(options,<span class="string">'nodeWeight'</span>)
0071     options.nodeWeight = ones(nNodes,1)*15;
0072     <span class="keyword">if</span> strcmp(CB_MAP_OUTPUT,<span class="string">'svg'</span>)
0073         options.nodeWeight = ones(nNodes,1)*25;
0074     <span class="keyword">end</span>
0075 <span class="keyword">end</span>
0076 
0077 <span class="keyword">if</span> ~isfield(options,<span class="string">'nodeWeightSecondary'</span>)
0078     options.nodeWeightSecondary = ones(nNodes,1)*10;
0079     <span class="keyword">if</span> strcmp(CB_MAP_OUTPUT,<span class="string">'svg'</span>)
0080         options.nodeWeightSecondary = ones(nNodes,1)*15;
0081     <span class="keyword">end</span>
0082 <span class="keyword">end</span>
0083 <span class="comment">%Node color</span>
0084 <span class="keyword">if</span> ~isfield(options,<span class="string">'nodeColor'</span>)
0085     options.nodeColor = repmat([255,160,128],nNodes,1);
0086 <span class="keyword">end</span>
0087 <span class="comment">%Edge color</span>
0088 <span class="keyword">if</span> ~isfield(options,<span class="string">'edgeColor'</span>)
0089     options.edgeColor = repmat([0,191,255],nEdges,1);
0090 <span class="keyword">end</span>
0091 <span class="comment">%Arrowhead color</span>
0092 <span class="keyword">if</span> ~isfield(options,<span class="string">'edgeArrowColor'</span>)
0093     options.edgeArrowColor = repmat([0,0,255],nEdges,1);
0094 <span class="keyword">end</span>
0095 <span class="comment">%Edge thickness</span>
0096 <span class="keyword">if</span> ~isfield(options,<span class="string">'edgeWeight'</span>)
0097     options.edgeWeight = ones(nEdges,1)*2;
0098     <span class="keyword">if</span> strcmp(CB_MAP_OUTPUT,<span class="string">'svg'</span>)
0099         options.edgeWeight = ones(nEdges,1)*4;
0100     <span class="keyword">end</span>
0101 <span class="keyword">end</span>
0102 <span class="comment">%Font Size</span>
0103 <span class="keyword">if</span> ~isfield(options,<span class="string">'textSize'</span>)
0104     options.textSize = ones(max(nNodes,nEdges),1)*12;
0105     <span class="keyword">if</span> strcmp(CB_MAP_OUTPUT,<span class="string">'svg'</span>)
0106         options.textSize = ones(max(nNodes,nEdges),1)*6;
0107     <span class="keyword">end</span>
0108 <span class="keyword">end</span>
0109 <span class="comment">%Font Color</span>
0110 <span class="keyword">if</span> ~isfield(options,<span class="string">'textColor'</span>)
0111     options.textColor= zeros(nNodes,3);
0112 <span class="keyword">end</span>
0113 
0114 <span class="comment">% if ~isfield(options,'otherTextSize')</span>
0115 <span class="comment">%     options.otherTextSize = ones(size(map.text,1),1)*12;</span>
0116 <span class="comment">%     if strcmp(CB_MAP_OUTPUT,'svg')</span>
0117 <span class="comment">%         options.otherTextSize = ones(size(map.text,1),1)*135;</span>
0118 <span class="comment">%     end</span>
0119 <span class="comment">% end</span>
0120 
0121 <span class="keyword">if</span> ~isfield(options,<span class="string">'otherTextColor'</span>)
0122     options.otherTextColor= zeros(size(map.text,1),3);
0123 <span class="keyword">end</span>
0124 
0125 nodeWeight = options.nodeWeightSecondary;
0126 nodeWeight(strcmp(map.molPrime,<span class="string">'Y'</span>)) = options.nodeWeight(strcmp(map.molPrime,<span class="string">'Y'</span>));
0127 
0128 <span class="keyword">if</span> ~isfield(options,<span class="string">'fileName'</span>)
0129     options.fileName = <span class="string">'target.svg'</span>;
0130 <span class="keyword">end</span>
0131 
0132 <span class="keyword">if</span> ~isfield(options,<span class="string">'rxnDir'</span>)
0133     options.rxnDir = zeros(size(map.connectionAbb,1),1);
0134 <span class="keyword">end</span>
0135 
0136 <span class="keyword">if</span> ~isfield(options,<span class="string">'rxnDirMultiplier'</span>)
0137     options.rxnDirMultiplier = 2;
0138 <span class="keyword">end</span>
0139 
0140 <span class="comment">%%%%%%%% initialization</span>
0141 <span class="keyword">if</span> strcmp(CB_MAP_OUTPUT,<span class="string">'matlab'</span>)    <span class="comment">% use matlab to draw the map</span>
0142     clf; <span class="comment">% this was in line 41 before</span>
0143     <span class="comment">% setting the color bar</span>
0144     figure(1);colormap(cool(100))
0145     colorbar(<span class="string">'location'</span>,<span class="string">'southoutside'</span>);
0146     axis equal;
0147     hold on
0148 <span class="keyword">elseif</span> strcmp(CB_MAP_OUTPUT, <span class="string">'java'</span>)
0149     <span class="comment">% use Java/OpenGL to draw the map</span>
0150     <a href="plotcbmap.html" class="code" title="function plotcbmap()">plotcbmap</a>;
0151     <span class="comment">% send the transformation coordinates</span>
0152     R=map.molPosition';
0153     R=sort(R);
0154     a=max(R);
0155     b=min(R);
0156     xmax=a(1,1);
0157     xmin=b(1,1);
0158     ymax=a(1,2);
0159     ymin=b(1,2);
0160     settrans(mapHandle,xmax,xmin,ymax,ymin);
0161 <span class="keyword">elseif</span> strcmp(CB_MAP_OUTPUT, <span class="string">'svg'</span>)
0162     <span class="comment">%check fileName extension</span>
0163     <span class="keyword">if</span> isempty(regexp(lower(options.fileName),<span class="string">'.svg$'</span>))
0164         options.fileName = strcat(options.fileName,<span class="string">'.svg'</span>);
0165     <span class="keyword">end</span>
0166     textPos = (map.textPos);
0167     x1 = min(map.molPosition(1,:));
0168     <span class="keyword">if</span> min(textPos(:,1))&lt;x1
0169         x1 = min(textPos(:,1));
0170     <span class="keyword">end</span>
0171     y1 = min(map.molPosition(2,:));
0172     <span class="keyword">if</span> min(textPos(:,2))&lt;y1
0173         y1 = min(textPos(:,2));
0174     <span class="keyword">end</span>
0175     x2 = max(map.molPosition(1,:));
0176     <span class="keyword">if</span> max(textPos(:,1))&gt;x2
0177         x2 = max(textPos(:,1));
0178     <span class="keyword">end</span>
0179     y2 = max(map.molPosition(2,:));
0180     <span class="keyword">if</span> max(textPos(:,2))&gt;y2
0181         y2 = max(textPos(:,2));
0182     <span class="keyword">end</span>
0183     <span class="keyword">if</span> isfield(options,<span class="string">'colorScale'</span>)
0184         numColorBins = size(options.colorScale,1);
0185         colorScaleWidth = 0.25*(x2-x1);
0186         binWidth = colorScaleWidth/numColorBins;
0187         colorScaleHeight = 0.05*colorScaleWidth;
0188         colorScaleBuffer = colorScaleHeight*1.5;
0189         y2 = y2+colorScaleBuffer; <span class="comment">%add buffer for scale</span>
0190     <span class="keyword">end</span>
0191     <span class="keyword">if</span> isfield(options,<span class="string">'fluxVarColor'</span>)
0192         colorScaleHeight = 0.0125*(x2-x1);
0193         colorScaleBuffer = colorScaleHeight*1.5;
0194         colorWidth = 0.025*(x2-x1);
0195         y2 = y2+colorScaleBuffer;
0196     <span class="keyword">end</span>
0197     [x1,y1,x2,y2] = deal(x1-200, y1-200, x2+200, y2+200); <span class="comment">% add buffer</span>
0198     SF = .25;
0199     mapHandle = fopen(options.fileName, <span class="string">'w'</span>);
0200     fprintf(mapHandle, <span class="string">'&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;\n'</span>);
0201     fprintf(mapHandle,<span class="string">'&lt;!DOCTYPE svg PUBLIC &quot;-//W3C//DTD SVG 1.0//EN&quot; &quot;http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd&quot;&gt;\n'</span>);
0202     fprintf(mapHandle,<span class="string">'&lt;svg height=&quot;%+.2f&quot; width=&quot;%+.2f&quot; viewBox=&quot;%+.2f %+.2f %+.2f %+.2f&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; xmlns:xlink=&quot;http://www.w3.org/1999/xlink&quot;&gt;\n'</span>,(y2-y1+20)*SF,(x2-x1+20)*SF,(x1-10)*SF,(y1-10)*SF,(x2-x1+0)*SF,(y2-y1+20)*SF);
0203     fprintf(mapHandle,<span class="string">'&lt;g transform=&quot;scale(%5.3f)&quot;&gt;\n'</span>,SF);
0204    
0205     <span class="comment">%Add Scale</span>
0206     <span class="keyword">if</span> isfield(options,<span class="string">'overlayType'</span>)
0207         <span class="keyword">for</span> i=1:numColorBins
0208             color = strcat(<span class="string">'rgb('</span>,num2str(options.colorScale(i,1)),<span class="string">','</span>,num2str(options.colorScale(i,2)),<span class="string">','</span>,num2str(options.colorScale(i,3)),<span class="string">')'</span>);
0209             fprintf(mapHandle,<span class="string">'&lt;g style=&quot;stroke-linecap: round; stroke-linejoin: round; stroke-miterlimit: 20; fill: %s; &quot;&gt;\n'</span>,color);
0210             fprintf(mapHandle,<span class="string">'&lt;rect x=&quot;%.2f&quot; y=&quot;%.2f&quot; width=&quot;%.2f&quot; height=&quot;%.2f&quot; /&gt;\n&lt;/g&gt;\n'</span>,x2-colorScaleWidth-200*2+(binWidth*(i-1)),y2-colorScaleHeight*1.25,binWidth,colorScaleHeight);
0211         <span class="keyword">end</span>
0212         fprintf(mapHandle, <span class="string">'&lt;g style=&quot;font-family: sans; stroke: none; text-anchor:end&quot;&gt;\n'</span>);
0213         fprintf(mapHandle,<span class="string">'&lt;text style=&quot;fill: rgb(0,0,0); text-rendering: optimizeLegibility;&quot; x=&quot;%.2f&quot; y=&quot;%.2f&quot; font-size=&quot;%dpx&quot;&gt;%s&lt;/text&gt;\n&lt;/g&gt;\n'</span>,x2-colorScaleWidth-200*2-0.25*colorScaleHeight,y2-colorScaleHeight*.4,colorScaleHeight,[<span class="string">'Scale: '</span> options.scaleTypeLabel <span class="string">'    '</span> options.overlayType <span class="string">': '</span> options.overlayLB]); 
0214         fprintf(mapHandle, <span class="string">'&lt;g style=&quot;font-family: sans; stroke: none; text-anchor:start&quot;&gt;\n'</span>);
0215         fprintf(mapHandle,<span class="string">'&lt;text style=&quot;fill: rgb(0,0,0); text-rendering: optimizeLegibility;&quot; x=&quot;%.2f&quot; y=&quot;%.2f&quot; font-size=&quot;%dpx&quot;&gt;%s&lt;/text&gt;\n&lt;/g&gt;\n'</span>,x2-200*2+0.25*colorScaleHeight,y2-colorScaleHeight*.4,colorScaleHeight,[options.overlayUB]); 
0216     <span class="keyword">end</span>
0217     <span class="keyword">if</span> isfield(options,<span class="string">'fluxVarColor'</span>)
0218         colorTextLabel = {<span class="string">'Bidirectional / reversible:'</span>, <span class="string">'Unidirectional / reversible forward:'</span>, <span class="string">'Unidirectional / reversible reverse:'</span>, <span class="string">'Unidirectional / irreversible:'</span>};
0219         color{1} = strcat(<span class="string">'rgb('</span>,num2str(options.fluxVarColor.biDirColor(1)),<span class="string">','</span>,num2str(options.fluxVarColor.biDirColor(2)),<span class="string">','</span>,num2str(options.fluxVarColor.biDirColor(3)),<span class="string">')'</span>);
0220         color{2} = strcat(<span class="string">'rgb('</span>,num2str(options.fluxVarColor.uniDirFwdColor(1)),<span class="string">','</span>,num2str(options.fluxVarColor.uniDirFwdColor(2)),<span class="string">','</span>,num2str(options.fluxVarColor.uniDirFwdColor(3)),<span class="string">')'</span>);
0221         color{3} = strcat(<span class="string">'rgb('</span>,num2str(options.fluxVarColor.uniDirRevColor(1)),<span class="string">','</span>,num2str(options.fluxVarColor.uniDirRevColor(2)),<span class="string">','</span>,num2str(options.fluxVarColor.uniDirRevColor(3)),<span class="string">')'</span>);
0222         color{4} = strcat(<span class="string">'rgb('</span>,num2str(options.fluxVarColor.uniDirIrrColor(1)),<span class="string">','</span>,num2str(options.fluxVarColor.uniDirIrrColor(2)),<span class="string">','</span>,num2str(options.fluxVarColor.uniDirIrrColor(3)),<span class="string">')'</span>);
0223         <span class="keyword">for</span> i=2:3:11
0224             fprintf(mapHandle, <span class="string">'&lt;g style=&quot;font-family: sans; stroke: none; text-anchor:end&quot;&gt;\n'</span>);
0225             fprintf(mapHandle,<span class="string">'&lt;text style=&quot;fill: rgb(0,0,0); text-rendering: optimizeLegibility;&quot; x=&quot;%.2f&quot; y=&quot;%.2f&quot; font-size=&quot;%dpx&quot;&gt;%s&lt;/text&gt;\n&lt;/g&gt;\n'</span>,i*(x2-x1)/12,y2-colorScaleHeight*.4,colorScaleHeight,colorTextLabel{ceil(i/3)});            
0226             fprintf(mapHandle,<span class="string">'&lt;g style=&quot;stroke-linecap: round; stroke-linejoin: round; stroke-miterlimit: 20; fill: %s; &quot;&gt;\n'</span>,color{ceil(i/3)});
0227             fprintf(mapHandle,<span class="string">'&lt;rect x=&quot;%.2f&quot; y=&quot;%.2f&quot; width=&quot;%.2f&quot; height=&quot;%.2f&quot; /&gt;\n&lt;/g&gt;\n'</span>,i*(x2-x1)/12,y2-colorScaleHeight*1.25,colorWidth,colorScaleHeight);
0228         <span class="keyword">end</span>
0229     <span class="keyword">end</span>
0230 <span class="keyword">end</span>
0231 
0232 <span class="comment">%%%%% actual map drawing code</span>
0233 <span class="comment">% draw other shapes</span>
0234 <span class="keyword">if</span> isfield(map,<span class="string">'shapeThickness'</span>)
0235     <span class="keyword">for</span> i = 1:size((map.shapeThickness),1)
0236         <a href="../../cobra/maps/tools/drawShape.html" class="code" title="function drawShape(sType,begPt,sLength, color, thickness,sStyle,verbose)">drawShape</a>(map.shapeType(i,1),map.shapePos(i,1:2),map.shapeSize(i,1:2),map.shapeColor(i,1:3),map.shapeThickness(i,1),map.shapeStyle(i,1));
0237     <span class="keyword">end</span>
0238 <span class="keyword">end</span>
0239 <span class="comment">% draw the connection segments traversing through the connection matrix</span>
0240 <span class="keyword">for</span> i = 1:(size((map.connection),1))
0241     <a href="../../cobra/maps/tools/drawLine.html" class="code" title="function drawLine(node1,node2,map,edgeColor,edgeArrowColor,edgeWeight,nodeWeight,rxnDir,rxnDirMultiplier)">drawLine</a>(map.connection(i,1),map.connection(i,2),map,options.edgeColor(i,:),options.edgeArrowColor(i,:),options.edgeWeight(i),nodeWeight,options.rxnDir(i),options.rxnDirMultiplier);
0242 <span class="keyword">end</span>
0243 <span class="comment">% draw the circles representing molecules</span>
0244 <span class="keyword">for</span> i = 1:size((map.molPosition),2)
0245     <a href="../../cobra/maps/tools/drawCircle.html" class="code" title="function drawCircle(p,radius,color)">drawCircle</a>(map.molPosition(:,i),nodeWeight(i),options.nodeColor(i,:));
0246 <span class="keyword">end</span>
0247 <span class="comment">% draw texts</span>
0248 <span class="keyword">for</span> i = 1:length(map.text)
0249     textFont =map.textFont{i};
0250     <span class="keyword">if</span> regexp(textFont,<span class="string">'@'</span>)
0251         [textFont, textSize] = strtok(textFont,<span class="string">'@'</span>);
0252         textSize = str2num(regexprep(textSize,<span class="string">'@'</span>,<span class="string">''</span>));
0253     <span class="keyword">elseif</span>(map.textSize(i) &gt;= 60)
0254         textSize = 60;
0255     <span class="keyword">else</span>
0256         textSize = map.textSize(i);
0257     <span class="keyword">end</span>
0258     <span class="keyword">if</span> find(regexp(textFont,<span class="string">'Italic'</span>))
0259         textStyle = <span class="string">'italic;'</span>;
0260     <span class="keyword">else</span>
0261         textStyle = <span class="string">''</span>;
0262     <span class="keyword">end</span>
0263     <span class="comment">%textFont</span>
0264     <span class="keyword">if</span> find(regexp(textFont,<span class="string">' B'</span>)) || find(regexp(textFont(end),<span class="string">'B'</span>))
0265         textWeight = <span class="string">'bold'</span>;
0266         textFont = regexprep(textFont,<span class="string">' B'</span>,<span class="string">''</span>);
0267     <span class="keyword">else</span>
0268         textWeight = <span class="string">''</span>;
0269     <span class="keyword">end</span>
0270     <span class="keyword">if</span> isfield(options,<span class="string">'otherTextSize'</span>), textSize = options.otherTextSize(i); <span class="keyword">end</span>
0271     <a href="../../cobra/maps/tools/drawText.html" class="code" title="function drawText(x,y, drawString, fontSize, fontStyle, color, font, fontWeight, flagCenter)">drawText</a>(map.textPos(i,1),map.textPos(i,2),map.text{i,1},textSize,textStyle,options.otherTextColor(i,:),lower(textFont),textWeight,true);
0272 <span class="keyword">end</span>
0273 <span class="comment">% Write Metabolite Label</span>
0274 <span class="keyword">for</span> i = 1:size((map.molPosition),2)  
0275     <span class="comment">% write the labels for molecules</span>
0276     <span class="keyword">if</span>(options.textSize(i) ~= 0)
0277         <a href="../../cobra/maps/tools/drawText.html" class="code" title="function drawText(x,y, drawString, fontSize, fontStyle, color, font, fontWeight, flagCenter)">drawText</a>(map.molLabelPos(i,1),map.molLabelPos(i,2),map.molAbbreviation{i},options.textSize(i),<span class="string">''</span>,options.textColor(i,:));
0278     <span class="keyword">end</span>
0279 <span class="keyword">end</span>
0280 <span class="comment">% Write Reaction Label</span>
0281 <span class="keyword">for</span> i = 1:size(map.rxnLabelPosition,2)
0282     <span class="keyword">if</span> ~any(isnan(map.rxnLabelPosition(:,i)))
0283       <span class="comment">%Currently there is not a default rxnTextSize in options.</span>
0284       <span class="keyword">if</span> isfield(options, <span class="string">'rxnTextSize'</span>)
0285         <a href="../../cobra/maps/tools/drawText.html" class="code" title="function drawText(x,y, drawString, fontSize, fontStyle, color, font, fontWeight, flagCenter)">drawText</a>(map.rxnLabelPosition(1,i),map.rxnLabelPosition(2,i),map.connectionAbb{find(map.rxnIndex(i)==map.connection,1)},options.rxnTextSize(i),<span class="string">'italic'</span>);
0286       <span class="keyword">else</span>
0287         <a href="../../cobra/maps/tools/drawText.html" class="code" title="function drawText(x,y, drawString, fontSize, fontStyle, color, font, fontWeight, flagCenter)">drawText</a>(map.rxnLabelPosition(1,i),map.rxnLabelPosition(2,i),map.connectionAbb{find(map.rxnIndex(i)==map.connection,1)},<span class="string">'italic'</span>);
0288       <span class="keyword">end</span>
0289     <span class="keyword">end</span>
0290 <span class="keyword">end</span>
0291 
0292 <span class="keyword">if</span> strcmp(CB_MAP_OUTPUT,<span class="string">'matlab'</span>)
0293     hold off;
0294 <span class="keyword">elseif</span> strcmp(CB_MAP_OUTPUT,<span class="string">'java'</span>)
0295     
0296 <span class="keyword">elseif</span> strcmp(CB_MAP_OUTPUT,<span class="string">'svg'</span>)
0297 
0298     fprintf(mapHandle,<span class="string">'&lt;/g&gt;\n'</span>);
0299     fprintf(mapHandle,<span class="string">'&lt;/svg&gt;\n'</span>);
0300     fclose(mapHandle);
0301     display(<span class="string">'Document Written'</span>)
0302 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Sun 26-Dec-2010 12:06:07 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2003</address>
</body>
</html>